# Generated by Chef
<%- if node[:logentries][:enable_tls] -%>
$DefaultNetstreamDriverCAFile node[:logentries][:ssl_cert_location]
$ActionSendStreamDriver gtls
$ActionSendStreamDriverMode 1
$ActionSendStreamDriverAuthMode x509/name
$ActionSendStreamDriverPermittedPeer *.logentries.com
<% end %>

$ActionResumeRetryCount <%= node[:logentries][:resume_retry_count] %>
$ActionQueueType LinkedList # use asynchronous processing
$ActionQueueFileName /var/log/rsyslog_queue_main # set file name, also enables disk mode
$ActionQueueSaveOnShutdown on
$ActionQueueMaxDiskSpace <%= node[:logentries][:queue_disk_space] %>

$template Logentries,"<%= get_log_key(node[:logentries][:log_name], node[:logentries][:host_name]) %> %HOSTNAME% %syslogtag%%msg%\n"
node[:logentries][:syslog_selector] @@api.logentries.com:10000;Logentries